<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Contact Hub</title>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<!-- Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<!-- QRCode.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

<!-- CSS -->
<style>
    body, html {
        margin:0; padding:0;
        font-family: 'Segoe UI', sans-serif;
        background: #0B1D51;
        color: #fff;
        overflow-x: hidden;
    }
    /* Landing Page */
    #landing {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100vh;
        text-align: center;
        background: radial-gradient(ellipse at bottom, #0B1D51 0%, #030918 100%);
        animation: pulse 5s infinite alternate;
    }
    #landing h1 {
        font-size: 4rem;
        background: linear-gradient(90deg, #00f6ff, #ff00f6);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 40px;
        text-shadow: 0 0 10px #00f6ff, 0 0 20px #ff00f6;
    }
    #landing button {
        padding: 15px 40px;
        font-size: 1.2rem;
        margin: 10px;
        border:none;
        border-radius: 8px;
        cursor:pointer;
        background: linear-gradient(90deg, #00f6ff, #ff00f6);
        color:#fff;
        transition: 0.3s;
        box-shadow: 0 0 10px #00f6ff, 0 0 20px #ff00f6;
    }
    #landing button:hover {
        transform: scale(1.1);
        box-shadow: 0 0 20px #00f6ff, 0 0 40px #ff00f6;
    }

    @keyframes pulse {
        0% {background-position:0% 50%;}
        100% {background-position:100% 50%;}
    }

    /* Forms */
    .form-container {
        display:none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100vh;
    }
    .form-card {
        background: rgba(255,255,255,0.05);
        padding: 40px;
        border-radius: 12px;
        box-shadow: 0 0 20px #00f6ff, 0 0 40px #ff00f6;
        min-width: 300px;
    }
    .form-card h2 {
        margin-bottom: 20px;
        text-align:center;
    }
    .form-card input {
        width: 100%;
        padding: 12px;
        margin: 10px 0;
        border:none;
        border-radius: 6px;
        background: rgba(255,255,255,0.1);
        color:#fff;
    }
    .form-card button {
        width: 100%;
        padding: 12px;
        margin-top: 10px;
        border:none;
        border-radius:6px;
        cursor:pointer;
        background: linear-gradient(90deg, #00f6ff, #ff00f6);
        color:#fff;
        font-size:1rem;
        box-shadow: 0 0 10px #00f6ff,0 0 20px #ff00f6;
        transition:0.3s;
    }
    .form-card button:hover {
        transform:scale(1.05);
    }

    /* Dashboard */
    #dashboard {
        display:none;
        padding:20px;
    }
    #dashboard h2 {
        text-align:center;
        margin-bottom:20px;
    }
    .tabs {
        display:flex;
        justify-content: center;
        gap:15px;
        margin-bottom:20px;
        flex-wrap: wrap;
    }
    .tab {
        padding:10px 20px;
        border-radius:6px;
        cursor:pointer;
        background: linear-gradient(90deg, #00f6ff, #ff00f6);
        color:#fff;
        transition:0.3s;
    }
    .tab:hover {
        transform:scale(1.05);
    }
    .tab.active {
        box-shadow: 0 0 15px #00f6ff,0 0 30px #ff00f6;
    }
    .tab-content {
        display:none;
    }
    .tab-content.active {
        display:block;
    }

    /* Contact List */
    .contact-card {
        display:flex;
        justify-content: space-between;
        align-items:center;
        padding:10px;
        margin:5px 0;
        border-radius:8px;
        background: rgba(255,255,255,0.05);
        box-shadow: 0 0 5px #00f6ff;
    }
    .contact-actions i {
        margin:0 5px;
        cursor:pointer;
        color:#00f6ff;
    }

    /* Add Contact Form */
    #addContactForm input, #addContactForm select {
        width: calc(50% - 10px);
        margin:5px;
        padding:10px;
        border:none;
        border-radius:6px;
        background: rgba(255,255,255,0.1);
        color:#fff;
    }
    #addContactForm label {
        margin-top:10px;
        display:block;
    }

    /* QR Code Container */
    #qrcode {
        margin-top:10px;
    }

</style>
</head>
<body>

<!-- Landing Page -->
<div id="landing">
    <h1>Contact Hub</h1>
    <button onclick="showForm('login')">Login</button>
    <button onclick="showForm('register')">Register</button>
</div>

<!-- Registration Form -->
<div id="register" class="form-container">
    <div class="form-card">
        <h2>Register</h2>
        <input type="text" id="regUsername" placeholder="Username (max 50 chars)">
        <input type="email" id="regEmail" placeholder="Email Address">
        <input type="password" id="regPassword" placeholder="Password">
        <input type="password" id="regConfirm" placeholder="Confirm Password">
        <button onclick="registerUser()">Create Profile</button>
        <p style="text-align:center; margin-top:10px;">Already have an account? <span style="color:#00f6ff; cursor:pointer;" onclick="showForm('login')">Login</span></p>
    </div>
</div>

<!-- Login Form -->
<div id="login" class="form-container">
    <div class="form-card">
        <h2>Login</h2>
        <input type="email" id="loginEmail" placeholder="Email Address">
        <input type="password" id="loginPassword" placeholder="Password">
        <button onclick="loginUser()">Login</button>
        <p style="text-align:center; margin-top:10px;">Don't have an account? <span style="color:#00f6ff; cursor:pointer;" onclick="showForm('register')">Register</span></p>
    </div>
</div>

<!-- Dashboard -->
<div id="dashboard">
    <h2>Welcome to Contact Hub</h2>
    <div class="tabs">
        <div class="tab active" onclick="openTab('allContacts', this)">All Contacts</div>
        <div class="tab" onclick="openTab('search', this)">Search</div>
        <div class="tab" onclick="openTab('addContact', this)">Add Contact</div>
        <div class="tab" onclick="openTab('favorites', this)">Favorites</div>
        <div class="tab" onclick="openTab('groups', this)">Groups</div>
        <div class="tab" onclick="openTab('blocked', this)">Blocked</div>
        <div class="tab" onclick="openTab('private', this)">Private</div>
        <div class="tab" onclick="openTab('emergency', this)">Emergency</div>
        <div class="tab" onclick="logoutUser()">Logout</div>
    </div>

    <div id="allContacts" class="tab-content active">
        <h3>All Contacts</h3>
        <div id="contactList"></div>
    </div>

    <div id="search" class="tab-content">
        <h3>Search Contacts</h3>
        <input type="text" id="searchInput" placeholder="Search by name or number" oninput="searchContacts()">
    </div>

    <div id="addContact" class="tab-content">
        <h3>Add New Contact</h3>
        <form id="addContactForm" onsubmit="addContact(event)">
            <input type="text" id="firstName" placeholder="First Name" required>
            <input type="text" id="surname" placeholder="Surname" required>
            <input type="text" id="phone" placeholder="Phone Number" required>
            <input type="email" id="email" placeholder="Email">
            <input type="date" id="dob">
            <select id="blood">
                <option value="">Blood Group</option>
                <option value="O+">O+</option>
                <option value="O-">O-</option>
                <option value="A+">A+</option>
                <option value="A-">A-</option>
                <option value="B+">B+</option>
                <option value="B-">B-</option>
                <option value="AB+">AB+</option>
                <option value="AB-">AB-</option>
            </select>
            <div>
                <label><input type="checkbox" id="groupFamily"> Family</label>
                <label><input type="checkbox" id="groupFriends"> Friends</label>
                <label><input type="checkbox" id="privateContact"> Private</label>
                <label><input type="checkbox" id="emergencyContact"> Emergency</label>
            </div>
            <button type="submit">Save Contact</button>
        </form>
        <div id="qrcode"></div>
    </div>

    <!-- Placeholder tabs -->
    <div id="favorites" class="tab-content"><h3>Favorites</h3></div>
    <div id="groups" class="tab-content"><h3>Groups</h3></div>
    <div id="blocked" class="tab-content"><h3>Blocked Contacts</h3></div>
    <div id="private" class="tab-content"><h3>Private Contacts</h3></div>
    <div id="emergency" class="tab-content"><h3>Emergency Contacts</h3></div>
</div>

<!-- JS -->
<script>
 // For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyBqyot01Qdc3VgxQWXWX_qLf25eTLbl-QY",
  authDomain: "contact-book-59258.firebaseapp.com",
  projectId: "contact-book-59258",
  storageBucket: "contact-book-59258.firebasestorage.app",
  messagingSenderId: "153490528056",
  appId: "1:153490528056:web:473a1ead13e6c64f1dd3cd",
  measurementId: "G-GC7D5Y46LG"
};
  firebase.initializeApp(firebaseConfig);
  const auth = firebase.auth();
  const db = firebase.firestore();

  // Show form
  function showForm(form){
    document.getElementById('landing').style.display='none';
    document.getElementById('register').style.display='none';
    document.getElementById('login').style.display='none';
    if(form==='register') document.getElementById('register').style.display='flex';
    if(form==='login') document.getElementById('login').style.display='flex';
  }

  // Open tabs
  function openTab(tab, element){
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    element.classList.add('active');
    document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));
    document.getElementById(tab).classList.add('active');
    if(tab==='allContacts') loadContacts();
  }

  // Register User
  function registerUser(){
    const username = document.getElementById('regUsername').value;
    const email = document.getElementById('regEmail').value;
    const password = document.getElementById('regPassword').value;
    const confirm = document.getElementById('regConfirm').value;
    if(username.length>50){ alert("Username max 50 chars"); return;}
    if(password.includes(" ")){ alert("Password cannot contain spaces"); return;}
    if(password!==confirm){ alert("Passwords do not match"); return;}
    auth.createUserWithEmailAndPassword(email, password)
    .then((userCredential)=>{
        db.collection("users").doc(userCredential.user.uid).set({username:username});
        alert("Profile created!");
        showForm('login');
    })
    .catch((error)=>{alert(error.message);});
  }

  // Login User
  function loginUser(){
    const email = document.getElementById('loginEmail').value;
    const password = document.getElementById('loginPassword').value;
    auth.signInWithEmailAndPassword(email, password)
    .then((userCredential)=>{
        document.getElementById('login').style.display='none';
        document.getElementById('dashboard').style.display='block';
        loadContacts();
    })
    .catch((error)=>{alert(error.message);});
  }

  // Logout
  function logoutUser(){
    auth.signOut().then(()=>{location.reload();});
  }

  // Add Contact
  function addContact(e){
    e.preventDefault();
    const user = auth.currentUser;
    if(!user) return alert("Not logged in");
    const data = {
      firstName: document.getElementById('firstName').value,
      surname: document.getElementById('surname').value,
      phone: document.getElementById('phone').value,
      email: document.getElementById('email').value,
      dob: document.getElementById('dob').value,
      blood: document.getElementById('blood').value,
      family: document.getElementById('groupFamily').checked,
      friends: document.getElementById('groupFriends').checked,
      private: document.getElementById('privateContact').checked,
      emergency: document.getElementById('emergencyContact').checked,
      timestamp: Date.now()
    };
    db.collection("users").doc(user.uid).collection("contacts").add(data)
    .then(()=>{
        alert("Contact added!");
        document.getElementById('addContactForm').reset();
        loadContacts();
        generateQR(data);
    });
  }

  // Load Contacts
  function loadContacts(){
    const user = auth.currentUser;
    if(!user) return;
    const list = document.getElementById('contactList');
    list.innerHTML='';
    db.collection("users").doc(user.uid).collection("contacts")
    .orderBy('firstName')
    .get()
    .then((snapshot)=>{
        snapshot.forEach(doc=>{
            const c = doc.data();
            const div = document.createElement('div');
            div.classList.add('contact-card');
            div.innerHTML = `<div>${c.firstName} ${c.surname}</div>
            <div class="contact-actions">
            <i class="fas fa-phone"></i>
            <i class="fas fa-comment"></i>
            <i class="fas fa-video"></i>
            <i class="fas fa-map-marker-alt"></i>
            <i class="fas fa-qrcode" onclick="generateQR(${JSON.stringify(c)})"></i>
            </div>`;
            list.appendChild(div);
        });
    });
  }

  // Search Contacts
  function searchContacts(){
    const query = document.getElementById('searchInput').value.toLowerCase();
    const user = auth.currentUser;
    if(!user) return;
    const list = document.getElementById('contactList');
    list.innerHTML='';
    db.collection("users").doc(user.uid).collection("contacts")
    .get()
    .then(snapshot=>{
        snapshot.forEach(doc=>{
            const c = doc.data();
            if(c.firstName.toLowerCase().includes(query) || c.phone.includes(query)){
                const div = document.createElement('div');
                div.classList.add('contact-card');
                div.innerHTML = `<div>${c.firstName} ${c.surname}</div>`;
                list.appendChild(div);
            }
        });
    });
  }

  // Generate QR
  function generateQR(data){
    document.getElementById('qrcode').innerHTML='';
    new QRCode(document.getElementById('qrcode'), {
        text: JSON.stringify(data),
        width:128,
        height:128
    });
  }

</script>

</body>
</html>
